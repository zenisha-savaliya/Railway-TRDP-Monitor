<div class="page-card">
  <div class="page-header">
    <svg viewBox="0 0 24 24" fill="currentColor">
      <path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"/>
    </svg>
    <h2>Write Data to Hardware</h2>
  </div>
  
  <div class="mb-6">
    <label class="block text-sm font-medium mb-3">Select Subsystem</label>
      <div class="subsystem-buttons">
        <button 
          *ngFor="let sub of configuredSubsystemNames"
          [class.active]="selectedSubsystem === sub"
          (click)="onSubsystemChange(sub)"
          class="btn btn-secondary"
        >
          {{ sub }}
        </button>
      </div>
      <div *ngIf="configuredSubsystemNames.length === 0" class="alert alert-warning">
        <p>No subsystems configured. Please configure subsystems first.</p>
      </div>
  </div>
  
  <div *ngIf="writableSignals.length === 0" class="alert alert-warning">
    <svg viewBox="0 0 24 24" fill="currentColor" width="20" height="20">
      <path d="M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"/>
    </svg>
    <p>No writable signals configured for {{ selectedSubsystem }} subsystem</p>
  </div>
  
  <div *ngFor="let comid of groupedByComId | keyvalue" class="comid-group">
    <div class="comid-header">
      <h3>COM ID: {{ comid.key }}</h3>
    </div>
    <div class="write-signals-container">
      <div *ngFor="let signal of comid.value" class="write-signal-item">
        <div class="signal-info">
          <h4>{{ signal.name }}</h4>
          <p>Type: {{ signal.datatype }} â€¢ Access: {{ signal.access }}</p>
        </div>
        <div *ngIf="signal.datatype === 'BOOLEAN'" class="boolean-controls">
          <button 
            [class.active]="writeData[signal.id] === false"
            (click)="writeData[signal.id] = false"
            class="btn btn-secondary"
          >
            OFF (0)
          </button>
          <button 
            [class.active]="writeData[signal.id] === true"
            (click)="writeData[signal.id] = true"
            class="btn btn-success"
          >
            ON (1)
          </button>
          <button 
            (click)="writeSignalValue(signal.id, writeData[signal.id])"
            class="btn btn-success"
          >
            Send
          </button>
        </div>
        <div *ngIf="signal.datatype !== 'BOOLEAN'" class="numeric-controls">
          <input 
            type="number"
            [step]="signal.datatype.includes('FLOAT') ? '0.01' : '1'"
            [(ngModel)]="writeData[signal.id]"
            [placeholder]="'Enter value (scaling: ' + signal.scaling + ')'"
            class="form-input"
          />
          <button 
            (click)="writeSignalValue(signal.id, writeData[signal.id])"
            class="btn btn-success"
          >
            Send
          </button>
        </div>
      </div>
      <div class="send-all-container">
        <button (click)="sendAllWriteData()" class="btn btn-primary">
          Send All to {{ selectedSubsystem }}
        </button>
      </div>
    </div>
  </div>
</div>
